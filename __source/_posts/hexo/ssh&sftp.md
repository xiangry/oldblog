title: "shell/ssh&sftp"
date: 2016-08-01 20:33:53
tags: hexo, shell
---

### 与远程服务器的交互（shell）

#### ssh

ssh是比较可靠的、专为`远程登录`会话和其他`网络服务`提供安全性的协议。

从客户端来看，SSH提供了两种级别的安全

1. **基于口令的安全验证：**
 
	只要知道账号和口令，记忆可以登录到远程主机。所有传输的数据都会被加密，但是不能保证你正在连接的服务器就是你想要连接的服务器，可能会有别的服务器在冒充真正的服务器，也就是收到"中间人"这种方式的攻击。

2. **基于秘钥的安全验证：**

	需要依靠秘钥，也就是你必须为自己创建一对秘钥，并把公共秘钥放在需要访问的服务器上。如果你要连接SSH服务器上，客户端就会向服务器发出请求，请求你的秘钥进行安全验证。服务器在收到请求后，先在该服务器上你的主要目录下寻找你的公共秘钥，然后把它和你发送过来的公共秘钥进行比较。如果一致，服务器就会用公共秘钥加密"质询（challenge）"并把它发送给客户端。客户端收到后既可以用你的私人秘钥进行解密，再发送给服务器。这种方式不需要在网上传送口令。避免了"中间人"这种攻击方式（因为没有你的私人秘钥）。但是整个登陆过程可能会需要10秒。

##### 常用方式

指定用户访问

```
ssh -l root 192.168.0.1
ssh root@192.168.0.1
```

如果修改过ssh登录端口可以

```
# 修改/etc/ssh/sshd_config 可以改ssh登录端口可机制root登录。改端口可以防止被端口扫描
# 修改端口 修改文件中的 #Port 22 改为  Port 123     
# 禁止root登录 修改文件中的 #PermitRootLogin yes 去掉注释
ssh -p 123 root@192.168.0.1
```

重试sshd服务

```
sevice sshd restart
```


#### sftp 

`sftp`是一个交互式文件传输程序。类似于`ftp`，但它机型加密传输，比`ftp`有更高的安全性。

实际上`sftp`是ssh的一个程序

###### 常用方式

登录

```
sftp root@192.168.0.1
```

获取远程服务器上的文件

```
sftp> get /home/teat  /User/x/Desktop/
```

发送数据到远程服务器上

```
sftp> put /User/x/Desktop/test /home/test
```

查看目录

```
pwd     # 查看远程当前路径
lpwd    # 查看本机工作路径
cd      # 改变远程路径
lcd     # 改变本地路径
# ls, rm, rmdir, mkdir 这些命令同理
```

离开sftp

```
# 以下命令同理
exit
quit
bye
```

